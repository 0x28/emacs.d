image: debian:sid

before_script:
  - apt-get update -yqq
  - apt-get install -yqq gpg emacs wget git
  - cp -r "$CI_PROJECT_DIR" ~/.emacs.d

test:
  script:
    - emacs --daemon -l ~/.emacs.d/init.el
    - emacsclient --eval "(kill-emacs)"
    - tar caf emacs.tar.xz --exclude "*.elc" --exclude ".git" -C ~ .emacs.d
  artifacts:
    paths:
      - emacs.tar.xz
    expire_in: 3 months
